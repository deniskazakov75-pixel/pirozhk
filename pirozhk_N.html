<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Пирожки России - Электронная ярмарка</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e);
            color: white;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: relative;
        }

        /* Анимированный фон */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .floating-element {
            position: absolute;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }

        .floating-element:nth-child(1) {
            width: 100px;
            height: 100px;
            top: 10%;
            left: 10%;
            animation-duration: 20s;
        }

        .floating-element:nth-child(2) {
            width: 150px;
            height: 150px;
            top: 70%;
            left: 80%;
            animation-duration: 25s;
        }

        .floating-element:nth-child(3) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 85%;
            animation-duration: 18s;
        }

        .floating-element:nth-child(4) {
            width: 120px;
            height: 120px;
            top: 80%;
            left: 15%;
            animation-duration: 22s;
        }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
            100% { transform: translateY(0) rotate(360deg); }
        }

        /* Контейнер сетки 3x3 */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            height: 100vh;
            width: 100vw;
            padding: 10px;
            transition: all 0.5s ease;
        }

        /* Карточка пирожка - ЯРКАЯ И АНИМИРОВАННАЯ */
        .pirozhok-card {
            background: linear-gradient(135deg, #2c3e50, #34495e, #2c3e50);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s ease;
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            animation: cardGlow 4s ease-in-out infinite alternate;
        }

        .pirozhok-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(52, 152, 219, 0.1), transparent);
            transform: rotate(45deg);
            animation: shine 6s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        @keyframes cardGlow {
            0% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5),
                          0 0 0px rgba(52, 152, 219, 0.3);
            }
            100% {
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5),
                          0 0 20px rgba(52, 152, 219, 0.6);
            }
        }

        .pirozhok-card:hover {
            border-color: #3498db;
            transform: scale(0.98) translateY(-5px);
            animation: none;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6),
                       0 0 25px rgba(52, 152, 219, 0.8);
        }

        .card-image {
            width: 100%;
            max-width: 180px;
            height: auto;
            aspect-ratio: 1;
            object-fit: cover;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 3px solid #3498db;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            transition: all 0.4s ease;
            position: relative;
            z-index: 2;
        }

        .pirozhok-card:hover .card-image {
            transform: scale(1.08) rotate(2deg);
            border-color: #2ecc71;
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }

        .card-title {
            font-size: clamp(1.3rem, 2.5vw, 2rem);
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            position: relative;
            z-index: 2;
        }

        .card-region {
            font-size: clamp(1rem, 1.8vw, 1.3rem);
            color: #ecf0f1;
            background: linear-gradient(135deg, #3498db, #2980b9);
            padding: 6px 15px;
            border-radius: 20px;
            position: relative;
            z-index: 2;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
        }

        .pirozhok-card:hover .card-region {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(46, 204, 113, 0.4);
        }

        /* Цена на главной странице */
        .card-price {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: clamp(0.9rem, 1.5vw, 1.2rem);
            box-shadow: 0 4px 10px rgba(231, 76, 60, 0.4);
            z-index: 3;
            animation: pricePulse 2s infinite alternate;
        }

        @keyframes pricePulse {
            0% {
                transform: scale(1);
                box-shadow: 0 4px 10px rgba(231, 76, 60, 0.4);
            }
            100% {
                transform: scale(1.05);
                box-shadow: 0 6px 15px rgba(231, 76, 60, 0.6);
            }
        }

        /* Заголовок ярмарки */
        .fair-title {
            position: fixed;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            z-index: 998;
            pointer-events: none;
        }

        .fair-title h1 {
            font-size: clamp(1.5rem, 3vw, 2.5rem);
            background: linear-gradient(135deg, #3498db, #2ecc71, #9b59b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
            margin-bottom: 5px;
        }

        .fair-title p {
            font-size: clamp(0.9rem, 1.5vw, 1.2rem);
            color: #bdc3c7;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        /* Остальные стили для модального окна остаются без изменений */
        /* Модальное окно на весь экран - КОМПАКТНЕЕ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a2a3a, #2c3e50);
            border-radius: 15px;
            padding: 20px;
            max-width: 95vw;
            max-height: 95vh;
            width: 1200px;
            position: relative;
            box-shadow: 0 0 50px rgba(52, 152, 219, 0.3);
            border: 3px solid #3498db;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: #2980b9;
            transform: scale(1.1);
        }

        /* Новая шапка модального окна с двумя колонками */
        .modal-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            align-items: start;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .modal-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 12px;
            margin-right: 20px;
            border: 2px solid #3498db;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-image:hover {
            transform: scale(1.05);
            border-color: #2ecc71;
        }

        .title-container h1 {
            font-size: clamp(1.3rem, 2.5vw, 2rem);
            font-weight: bold;
            margin-bottom: 6px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .modal-region {
            font-size: clamp(0.8rem, 1.5vw, 1.1rem);
            background: #3498db;
            padding: 4px 12px;
            border-radius: 12px;
            display: inline-block;
        }

        .header-right {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .modal-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        /* Левая колонка: Особенности и Фото */
        .left-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .modal-features {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #2ecc71;
        }

        .features-title {
            font-size: clamp(0.9rem, 1.6vw, 1.2rem);
            margin-bottom: 12px;
            color: #2ecc71;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
        }

        .feature-item {
            background: rgba(52, 152, 219, 0.2);
            padding: 8px 6px;
            border-radius: 6px;
            text-align: center;
            font-size: clamp(0.7rem, 1.1vw, 0.9rem);
            border: 1px solid rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(52, 152, 219, 0.4);
            transform: translateY(-2px);
        }

        /* Правая колонка: Интересный факт и оплата */
        .right-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Полноценный аудиоплеер */
        .audio-player {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #3498db;
            width: 100%;
        }

        .audio-player-title {
            font-size: clamp(0.9rem, 1.6vw, 1.2rem);
            margin-bottom: 12px;
            color: #3498db;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .play-btn {
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            background: #27ae60;
            transform: scale(1.1);
        }

        .play-btn.playing {
            background: #e74c3c;
        }

        .progress-container {
            flex-grow: 1;
            background: rgba(255, 255, 255, 0.1);
            height: 6px;
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .progress-bar {
            background: #3498db;
            height: 100%;
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s ease;
        }

        .time-display {
            font-size: 0.9rem;
            color: #bdc3c7;
            min-width: 80px;
            text-align: center;
        }

        /* Стили для фотографии */
        .photo-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #f39c12;
        }

        .photo-title {
            font-size: clamp(0.9rem, 1.6vw, 1.2rem);
            margin-bottom: 12px;
            color: #f39c12;
        }

        .pirozhok-photo {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .pirozhok-photo:hover {
            transform: scale(1.02);
        }

        /* Интересный факт */
        .modal-fact {
            font-size: clamp(0.8rem, 1.3vw, 1rem);
            line-height: 1.4;
            color: #ecf0f1;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #9b59b6;
        }

        .fact-title {
            font-size: clamp(0.9rem, 1.6vw, 1.2rem);
            margin-bottom: 10px;
            color: #9b59b6;
        }

        /* Блок оплаты */
        .payment-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #e74c3c;
            margin-top: 8px;
        }

        .payment-title {
            font-size: clamp(0.9rem, 1.6vw, 1.2rem);
            margin-bottom: 15px;
            color: #e74c3c;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .price-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
            position: relative;
            overflow: hidden;
        }

        .price-display::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        .price-label {
            font-size: clamp(0.9rem, 1.4vw, 1.1rem);
            color: rgba(255, 255, 255, 0.9);
        }

        .price-amount {
            font-size: clamp(1.3rem, 2.2vw, 1.8rem);
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .qr-code-container {
            text-align: center;
            margin-bottom: 15px;
        }

        .qr-code {
            width: 180px;
            height: 180px;
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 10px;
            background: white;
            margin: 0 auto 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        .qr-code:hover {
            transform: scale(1.03);
            border-color: #2ecc71;
        }

        .payment-instruction {
            font-size: clamp(0.8rem, 1.2vw, 1rem);
            color: #bdc3c7;
            margin-bottom: 5px;
        }

        .payment-methods {
            display: flex;
            justify-content: space-around;
            gap: 8px;
            font-size: clamp(0.7rem, 1.1vw, 0.9rem);
            margin-top: 12px;
        }

        .method {
            background: rgba(52, 152, 219, 0.15);
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid rgba(52, 152, 219, 0.3);
            text-align: center;
            flex: 1;
            transition: all 0.3s ease;
        }

        .method:hover {
            background: rgba(52, 152, 219, 0.25);
            transform: translateY(-2px);
        }

        .modal-footer {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            font-size: clamp(0.8rem, 1.3vw, 1rem);
            color: #bdc3c7;
            border-top: 2px solid #3498db;
        }

        /* Анимации */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pirozhok-card {
            animation: fadeIn 0.5s ease forwards, cardGlow 4s ease-in-out infinite alternate;
        }

        /* Фуллскрин для фото */
        .photo-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            cursor: pointer;
        }

        .photo-fullscreen.active {
            display: flex;
        }

        .photo-fullscreen img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }

        /* Инструкция */
        .instructions {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 12px 25px;
            border-radius: 10px;
            font-size: clamp(0.8rem, 1.3vw, 1rem);
            z-index: 999;
            border: 1px solid #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
            animation: instructionPulse 3s infinite alternate;
        }

        @keyframes instructionPulse {
            0% {
                box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
            }
            100% {
                box-shadow: 0 0 20px rgba(52, 152, 219, 0.8);
            }
        }

        /* Адаптивность для различных размеров экранов */
        @media (max-width: 1024px) {
            .modal-body {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95vw;
                padding: 18px;
            }
            
            .grid-container {
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: repeat(5, 1fr);
            }
            
            .modal-header {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .header-left {
                justify-content: center;
                text-align: center;
            }
            
            .header-right {
                order: -1;
            }
        }

        @media (max-width: 600px) {
            .grid-container {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(9, 1fr);
            }
            
            .modal-content {
                padding: 15px;
            }
            
            .modal-header {
                margin-bottom: 15px;
                gap: 12px;
            }
            
            .modal-body {
                gap: 15px;
                margin-bottom: 15px;
            }
            
            .left-column,
            .right-column {
                gap: 12px;
            }
            
            .modal-features,
            .audio-player,
            .photo-container,
            .modal-fact,
            .payment-section {
                padding: 12px;
            }
            
            .features-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
            
            .price-display {
                padding: 12px;
                flex-direction: column;
                gap: 8px;
                text-align: center;
            }
            
            .qr-code {
                width: 140px;
                height: 140px;
            }
        }
    </style>
</head>
<body>
    <!-- Анимированный фон -->
    <div class="floating-elements">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>

    <!-- Заголовок ярмарки -->
    <div class="fair-title">
        <h1>🎪 Электронная Ярмарка Пирожков</h1>
        <p>Выберите пирожок для заказа</p>
    </div>

    <div class="grid-container" id="gridContainer">
        <!-- Блоки пирожков будут сгенерированы JavaScript -->
    </div>

    <div class="instructions">
        Нажмите на любой пирожок для подробной информации (для выхода нажмите ESC или крестик)
    </div>

    <!-- Модальное окно -->
    <div class="modal" id="pirozhokModal">
        <div class="modal-content">
            <button class="close-btn" id="closeModal">×</button>
            
            <!-- Новая шапка с двумя колонками -->
            <div class="modal-header">
                <div class="header-left">
                    <img class="modal-image" id="modalImage" alt="Пирожок">
                    <div class="title-container">
                        <h1 class="modal-title" id="modalTitle">Название пирожка</h1>
                        <div class="modal-region" id="modalRegion">Регион</div>
                    </div>
                </div>
                
                <div class="header-right">
                    <div class="audio-player" id="audioPlayer">
                        <h3 class="audio-player-title">🔊 Аудиоописание</h3>
                        <div class="audio-controls">
                            <button class="play-btn" id="playBtn">❚❚</button>
                            <div class="progress-container" id="progressContainer">
                                <div class="progress-bar" id="progressBar"></div>
                            </div>
                            <div class="time-display" id="timeDisplay">0:00 / 0:00</div>
                        </div>
                        <audio id="audioElement" preload="metadata"></audio>
                    </div>
                </div>
            </div>
            
            <div class="modal-body">
                <!-- Левая колонка: Особенности и Фото -->
                <div class="left-column">
                    <div class="modal-features">
                        <h3 class="features-title">Особенности</h3>
                        <div class="features-grid" id="modalFeatures">
                            <!-- Особенности будут добавлены через JS -->
                        </div>
                    </div>
                    
                    <div class="photo-container" id="photoContainer" style="display: none;">
                        <h3 class="photo-title">📷 Внешний вид</h3>
                        <img class="pirozhok-photo" id="pirozhokPhoto" alt="Фотография пирожка">
                    </div>
                </div>
                
                <!-- Правая колонка: Интересный факт и оплата -->
                <div class="right-column">
                    <div class="modal-fact" id="modalFact">
                        <h3 class="fact-title">💡 Интересный факт</h3>
                        <div id="factText">Интересный факт о пирожке будет здесь...</div>
                    </div>

                    <!-- Блок оплаты -->
                    <div class="payment-section">
                        <h3 class="payment-title">💳 Оплата заказа</h3>
                        <div class="price-display">
                            <span class="price-label">Сумма к оплате:</span>
                            <span class="price-amount" id="modalPrice">0 руб.</span>
                        </div>
                        <div class="qr-code-container">
                            <img src="images/qr-code.png" alt="QR-код для оплаты" class="qr-code">
                            <div class="payment-instruction">
                                Отсканируйте QR-код для оплаты через СБП
                            </div>
                        </div>
                        <div class="payment-methods">
                            <div class="method">✓ Картой онлайн</div>
                            <div class="method">✓ СБП (QR-код)</div>
                            <div class="method">✓ Наличными</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                Управление Федерального казначейства по Забайкальскому краю • Презентация для жюри
            </div>
        </div>
    </div>

    <!-- Фуллскрин для фото -->
    <div class="photo-fullscreen" id="photoFullscreen">
        <img id="fullscreenImage" alt="Увеличенное фото пирожка">
    </div>

    <script>
        // Данные о пирожках (9 пирожков для сетки 3x3)
        const pirozhkiData = [
            {
                id: 1,
                name: "Хушур",
                region: "Бурятия",
                price: 150,
                fact: "Бурятские жареные пирожки с мясной начинкой. Традиционно готовятся из баранины или говядины с добавлением лука и специй. Подаются горячими. Интересные факты: хушур - обязательное блюдо на бурятском празднике Сагаалган. Идеальные бурятские хушуры по традиции должны иметь тридцать три защипа. Это связывается с распространением буддизма и имитирует тридцать три складки на одежде буддийских монахов. А способность сделать такое количество защипов на пирожке, помещающемся в ладонь, свидетельствовала об искусности хозяйки. Считается, что чем сочнее хушур, тем щедрее и хлебосольнее хозяйка.",
                features: ["Жареные", "Баранина", "Говядина", "Лук", "Специи", "Бурятская кухня", "Горячая подача", "Праздничное блюдо"],
                image: "images/icons/hushur.png",
                audio: "audio/hushur.mp3",
                photo: "images/photos/hushur.png"
            },
            {
                id: 2,
                name: "Кокрок",
                region: "Удмуртия",
                price: 120,
                fact: "Удмурский пирог с начинкой из мяса и картофеля, традиционно выпекаемый в печи. Кокрок имеет продолговатую форму и золотистую корочку. Интересный факт: название 'кокрок' переводится с удмурского как 'пятка', что связано с характерной формой этого пирога. В старину кокрок брали с собой в долгие поездки и на охоту, так как он долго сохраняет свежесть и не крошится.",
                features: ["Продолговатая форма", "Мясная начинка", "Картофель", "Лук", "Печная выпечка", "Башкирская кухня", "Золотистая корочка", "Долгое хранение"],
                image: "images/icons/kokrok.png",
                audio: "audio/kokrok.mp3",
                photo: "images/photos/kokrok.png"
            },
            {
                id: 3,
                name: "Курник",
                region: "Русский Север",
                price: 350,
                fact: "Царский пирог с несколькими слоями начинки, традиционное блюдо на праздники. Считался свадебным пирогом на Руси. Отличается сложной многослойной структурой и богатым составом начинок. Высота курника может достигать 15-20 см. Курник был любимым блюдом Ивана Грозного, который с удовольствием угощал им бояр. В старину курник выпекали в печи на берёзовых поленьях. Готовность проверяли так: подцепляли пирог с одного угла. Если он не гнулся — значит, курник готов.",
                features: ["Многослойный", "Куриное мясо", "Грибы", "Яйца", "Рис или гречка", "Свадебный пирог", "Высокая форма", "Богатая начинка"],
                image: "images/icons/kurnik.png",
                audio: "audio/kurnik.mp3",
                photo: "images/photos/kurnik.jpg"
            },
            {
                id: 4,
                name: "Эчпочмак",
                region: "Татарстан",
                price: 130,
                fact: "Треугольный пирожок с начинкой из мяса, картофеля и лука. Название переводится с татарского как 'треугольник'. Традиционно подается с бульоном, который заливается в специальное отверстие в тесте. Интересный факт: эчпочмак - одно из немногих блюд татарской кухни, которое не имеет аналогов у других тюркских народов. В Казани даже установлен памятник эчпочмаку, что подчеркивает его важность в культуре татарского народа.",
                features: ["Треугольная форма", "Баранина", "Говядина", "Картофель", "Подача с бульоном", "Татарская кухня", "Сочная начинка", "Отверстие для бульона"],
                image: "images/icons/echpochmak.png",
                audio: "audio/echpochmak.mp3",
                photo: "images/photos/echpochmak.png"
            },
            {
                id: 5,
                name: "Осетинский пирог",
                region: "Северная Осетия",
                price: 280,
                fact: "Осетинский пирог - Тонкий пирог с разнообразными начинками, имеющий сакральное значение в осетинской культуре. По осетинскому обычаю, пироги преломляются за столом как хлеб мира и согласия. Интересный факт: традиционно осетинские пироги готовят только женщины, и умение печь их считается особым искусством, передающимся из поколения в поколение. Во время выпекания они покрывают свои головы платками так, чтобы рот был прикрыт. Этот ритуал предназначен для того, чтобы не осквернить выпечку дыханием человека. Так же считается, что приступать к работе надо с чистыми мыслями и хорошим настроением, тогда осетинские пироги получаются ароматными и сочными.",
                features: ["Тонкое тесто", "Сыр сулугуни", "Говядина", "Листья свеклы", "Картофель", "Сакральное значение", "Ручная лепка", "Дровяная печь"],
                image: "images/icons/osetinskiy.png",
                audio: "audio/osetinskiy.mp3",
                photo: "images/photos/osetinskiy.png"
            },			
            {
                id: 6,
                name: "Шаньга",
                region: "Урал",
                price: 90,
                fact: "Открытая лепешка с различными начинками, традиционное блюдо уральской и сибирской кухни. Шаньги могут быть как солеными, так и сладкими. Интересный факт: на Урале шаньги называли 'сибирскими ватрушками'. Существовала традиция: когда в семье рождалась девочка, пекли шаньги и раздавали соседям, чтобы жизнь у малышки была такой же сытной и благополучной. Шаньги часто брали с собой в поле работники, так как они не портились в течение всего дня.",
                features: ["Открытая форма", "Картофельная начинка", "Творожная начинка", "Сметана", "Сытность", "Уральская кухня", "Лепешка", "Разные начинки"],
                image: "images/icons/shanga.png",
                audio: "audio/shanga.mp3",
                photo: "images/photos/shanga.png"
            },
            {
                id: 7,
                name: "Бэлиш",
                region: "Башкирия",
                price: 0,
                fact: "Бэлиш - Большой пирог с начинкой из мяса и картофеля. Традиционно готовился в печи. Предназначен для большой семьи или компании. Отличается сочной начинкой и хрустящей корочкой. Интересный факт: бэлиш всегда готовили к большим праздникам и важным событиям. По Башкирской традиции, бэлиш резал самый старший член семьи, что символизировало уважение к возрасту и мудрости. Вак-бэлиш. Название говорит само за себя. Вак в переводе с башкирского означает маленький,  а Бэлиш – это общее название. Таким образом, вак-бэлиш – это маленький Бэлиш.",
                features: ["Большой размер", "Мясная начинка", "Картофель", "Лук", "Для большой семьи", "Татарская кухня", "Хрустящая корочка", "Праздничное блюдо"],
                image: "images/icons/belish.png",
                audio: "audio/belish.mp3",
                photo: "images/photos/belish.png"
            },
            {
                id: 8,
                name: "Расстегай",
                region: "Центральная Россия",
                price: 110,
                fact: "Открытый пирожок с различными начинками, традиционно подаётся с бульоном. Исторически был популярен в трактирах Москвы и других городов Центральной России. Отличается характерной открытой формой, позволяющей добавить бульон непосредственно перед употреблением. Интересный факт: в XIX веке расстегаи были визитной карточкой московских трактиров. Их подавали к рыбному бульону, и считалось, что именно сочетание расстегая с ухой создает неповторимый вкус. Слово 'расстегай' происходит от глагола 'расстегивать', так как начинка видна, будто расстегнутая одежда.",
                features: ["Открытая форма", "Рыбная начинка", "Мясная начинка", "Грибная начинка", "Подача с бульоном", "Трактирное блюдо", "Сочная начинка", "Московская кухня"],
                image: "images/icons/rasstegai.png",
                audio: "audio/rasstegai.mp3",
                photo: "images/photos/rasstegai.png"
            },
			{
                id: 9,
                name: "Калитки",
                region: "Карелия",
                price: 85,
                fact: "Небольшие открытые пирожки с разнообразными начинками. Традиционное блюдо карельской кухни. Интересный факт: калитки называют хлебом с начинкой, так как они заменяли хлеб во время трапезы. По карельскому обычаю, чем тоньше тесто у калитки, тем искуснее считается хозяйка. Самая популярная начинка - перловая каша, что делает калитки уникальными среди других пирожков.",
                features: ["Открытая форма", "Ржаное тесто", "Перловая каша", "Картофель", "Творог", "Карельская кухня", "Небольшой размер", "Тонкое тесто"],
                image: "images/icons/kalitki.png",
                audio: "audio/kalitki.mp3",
                photo: "images/photos/kalitki.png"
            },
        ];

        // Элементы DOM
        const gridContainer = document.getElementById('gridContainer');
        const modal = document.getElementById('pirozhokModal');
        const closeModal = document.getElementById('closeModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalRegion = document.getElementById('modalRegion');
        const modalImage = document.getElementById('modalImage');
        const factText = document.getElementById('factText');
        const modalFeatures = document.getElementById('modalFeatures');
        const audioPlayer = document.getElementById('audioPlayer');
        const audioElement = document.getElementById('audioElement');
        const playBtn = document.getElementById('playBtn');
        const progressBar = document.getElementById('progressBar');
        const progressContainer = document.getElementById('progressContainer');
        const timeDisplay = document.getElementById('timeDisplay');
        const photoContainer = document.getElementById('photoContainer');
        const pirozhokPhoto = document.getElementById('pirozhokPhoto');
        const photoFullscreen = document.getElementById('photoFullscreen');
        const fullscreenImage = document.getElementById('fullscreenImage');
        const modalPrice = document.getElementById('modalPrice');

        // Переменные для управления аудио
        let isPlaying = false;
        let currentAudio = null;

        // Генерация сетки пирожков 3x3
        pirozhkiData.forEach(pirozhok => {
            const card = document.createElement('div');
            card.className = 'pirozhok-card';
            card.style.animationDelay = `${pirozhok.id * 0.1}s`;
            card.innerHTML = `
                <div class="card-price">${pirozhok.price} руб.</div>
                <img class="card-image" src="${pirozhok.image}" alt="${pirozhok.name}" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%2334495e%22/><text x=%2250%22 y=%2250%22 font-size=%2220%22 text-anchor=%22middle%22 alignment-baseline=%22middle%22 fill=%22%23fff%22>${pirozhok.name}</text></svg>'">
                <div class="card-title">${pirozhok.name}</div>
                <div class="card-region">${pirozhok.region}</div>
            `;
            
            // Обработчик клика - открытие модального окна
            card.addEventListener('click', () => openModal(pirozhok));
            
            gridContainer.appendChild(card);
        });

        // Функция открытия модального окна
        function openModal(pirozhok) {
            // Останавливаем текущее аудио, если оно играет
            if (currentAudio) {
                stopAudio();
            }
            
            // Устанавливаем основную информацию
            modalTitle.textContent = pirozhok.name;
            modalRegion.textContent = pirozhok.region;
            modalImage.src = pirozhok.image;
            modalImage.alt = pirozhok.name;
            factText.textContent = pirozhok.fact;
            modalPrice.textContent = `${pirozhok.price} руб.`;
            
            // Очистка и заполнение особенностей
            modalFeatures.innerHTML = '';
            pirozhok.features.forEach(feature => {
                const featureItem = document.createElement('div');
                featureItem.className = 'feature-item';
                featureItem.textContent = feature;
                modalFeatures.appendChild(featureItem);
            });
            
            // Настройка аудиоплеера
            if (pirozhok.audio) {
                audioElement.src = pirozhok.audio;
                audioPlayer.style.display = 'block';
                resetAudioProgress();
                
                // АВТОЗАПУСК АУДИО
                setTimeout(() => {
                    playAudio();
                }, 300);
            } else {
                audioPlayer.style.display = 'none';
            }
            
            // Настройка фотографии
            if (pirozhok.photo) {
                pirozhokPhoto.src = pirozhok.photo;
                pirozhokPhoto.alt = `Фотография ${pirozhok.name}`;
                photoContainer.style.display = 'block';
            } else {
                photoContainer.style.display = 'none';
            }
            
            // Обработчики для кликабельных изображений
            modalImage.onclick = () => {
                if (pirozhok.photo) {
                    fullscreenImage.src = pirozhok.photo;
                    photoFullscreen.classList.add('active');
                }
            };
            
            pirozhokPhoto.onclick = () => {
                fullscreenImage.src = pirozhok.photo;
                photoFullscreen.classList.add('active');
            };
            
            // Показ модального окна
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Функции для управления аудио
        function toggleAudio() {
            if (isPlaying) {
                pauseAudio();
            } else {
                playAudio();
            }
        }

        function playAudio() {
            audioElement.play();
            isPlaying = true;
            playBtn.textContent = '❚❚';
            playBtn.classList.add('playing');
        }

        function pauseAudio() {
            audioElement.pause();
            isPlaying = false;
            playBtn.textContent = '▶';
            playBtn.classList.remove('playing');
        }

        function stopAudio() {
            pauseAudio();
            audioElement.currentTime = 0;
            resetAudioProgress();
        }

        function resetAudioProgress() {
            progressBar.style.width = '0%';
            timeDisplay.textContent = '0:00 / 0:00';
        }

        function updateProgress() {
            const { currentTime, duration } = audioElement;
            const progressPercent = (currentTime / duration) * 100;
            progressBar.style.width = `${progressPercent}%`;
            
            const formatTime = (time) => {
                const minutes = Math.floor(time / 60);
                const seconds = Math.floor(time % 60);
                return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            };
            
            timeDisplay.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
        }

        function setProgress(e) {
            const width = this.clientWidth;
            const clickX = e.offsetX;
            const duration = audioElement.duration;
            
            audioElement.currentTime = (clickX / width) * duration;
        }

        // Обработчики событий для аудио
        playBtn.addEventListener('click', toggleAudio);
        audioElement.addEventListener('timeupdate', updateProgress);
        audioElement.addEventListener('ended', () => {
            isPlaying = false;
            playBtn.textContent = '▶';
            playBtn.classList.remove('playing');
        });
        progressContainer.addEventListener('click', setProgress);

        // Функция закрытия модального окна
        function closeModalFunc() {
            // Останавливаем аудио при закрытии
            if (isPlaying) {
                stopAudio();
            }
            
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Закрытие фуллскрина фото
        function closeFullscreen() {
            photoFullscreen.classList.remove('active');
        }

        // Обработчики событий
        closeModal.addEventListener('click', closeModalFunc);
        photoFullscreen.addEventListener('click', closeFullscreen);

        // Закрытие по клику вне контента
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModalFunc();
            }
        });

        // Закрытие по клавише ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (photoFullscreen.classList.contains('active')) {
                    closeFullscreen();
                } else {
                    closeModalFunc();
                }
            }
        });

        // Автоматическое скрытие инструкции
        setTimeout(() => {
            document.querySelector('.instructions').style.opacity = '0';
            setTimeout(() => {
                document.querySelector('.instructions').style.display = 'none';
            }, 1000);
        }, 10000);
    </script>
</body>
</html>